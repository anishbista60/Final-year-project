(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{536:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return k}});var a=s(9268),r=s(4751),l=s(6008),n=s(6006),o=s(7797),c=s(7578);let i=e=>{let{className:t}=e;return(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:t,children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 12L3.269 3.126A59.768 59.768 0 0121.485 12 59.77 59.77 0 013.27 20.876L5.999 12zm0 0h7.5"})})};var u=s(4310),d=s(8037),h=s(6394),x=s.n(h);let g=()=>(0,a.jsx)("span",{className:"animate-spin bg-white h-6 w-[5px] rounded"}),m=e=>{let{className:t}=e;return(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:t,children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"})})};d.TU.setOptions({highlight:function(e,t){let s=u.Z.getLanguage(t)?t:"plaintext";return u.Z.highlight(e,{language:s}).value}});let f=e=>{let{content:t,is_from_bot:s,loading:r=!1}=e;return(0,a.jsx)("li",{className:"w-full text-gray-100 ".concat(s?"bg-gray-800":"bg-gray-600"),children:(0,a.jsxs)("div",{className:"flex-col",children:[(0,a.jsxs)("div",{className:"md:max-w-2xl lg:max-w-xl xl:max-w-3xl py-6 m-auto flex flex-row items-start space-x-4",children:[s?(0,a.jsx)(x(),{src:"/assets/chat-gpt-logo.png",width:30,height:30,alt:"Chat GPT Logo"}):(0,a.jsx)(m,{className:"w-[30px] flex flex-col relative start"}),(0,a.jsx)("div",{className:"relative w-[calc(100%-115px)] flex flex-col gap-1 transition duration-100 ease-linear break-words",dangerouslySetInnerHTML:{__html:(0,d.TU)(t,{breaks:!0})}})]}),r&&(0,a.jsx)("div",{className:"flex items-center justify-center pb-2",children:(0,a.jsx)(g,{})})]})})},w=e=>{let{children:t}=e;return(0,a.jsx)("li",{className:"w-full text-gray-100 bg-gray-800",children:(0,a.jsxs)("div",{className:"md:max-w-2xl lg:max-w-xl xl:max-w-3xl py-6 m-auto flex flex-row items-start space-x-4",children:[(0,a.jsx)(x(),{src:"/assets/chat-gpt-logo.png",width:30,height:30,alt:"Chat GPT Logo"}),(0,a.jsx)("div",{className:"relative w-[calc(100%-115px)] flex flex-col gap-1",children:(0,a.jsxs)("span",{className:"text-red-500",children:["Ops! Ocorreu um erro: ",t]})})]})})},p=e=>{let{className:t}=e;return(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:t,children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 9V5.25A2.25 2.25 0 0013.5 3h-6a2.25 2.25 0 00-2.25 2.25v13.5A2.25 2.25 0 007.5 21h6a2.25 2.25 0 002.25-2.25V15m3 0l3-3m0 0l-3-3m3 3H9"})})},v=e=>{let{className:t}=e;return(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:t,children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M7.5 8.25h9m-9 3H12m-9.75 1.51c0 1.6 1.123 2.994 2.707 3.227 1.129.166 2.27.293 3.423.379.35.026.67.21.865.501L12 21l2.755-4.133a1.14 1.14 0 01.865-.501 48.172 48.172 0 003.423-.379c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0012 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018z"})})},j=e=>{let{className:t}=e;return(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",className:t,children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})})};class y{static async get(e){let t=await fetch("".concat(y.API_URL,"/").concat(e)),s=await t.json();if(!t.ok)throw Error(s.message);return s}static async post(e,t){let s=await fetch("".concat(y.API_URL,"/").concat(e),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),a=await s.json();if(!s.ok)throw Error(a.message);return a}static async put(e,t){let s=await fetch("".concat(y.API_URL,"/").concat(e),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),a=await s.json();if(!s.ok)throw Error(a.message);return a}static async delete(e){let t=await fetch("".concat(y.API_URL,"/").concat(e),{method:"DELETE"}),s=await t.json();if(!t.ok)throw Error(s.message);return s}}y.API_URL="/api";let b=e=>y.get(e),N=()=>{let e=(0,l.useRouter)(),t=(0,l.useSearchParams)(),s=t.get("chatId"),[u,d]=(0,n.useState)(s),[h,x]=(0,n.useState)(null),g=(0,n.useRef)(null),m=(0,n.useRef)(null),{data:N,mutate:k}=(0,o.ZP)("/chats",b,{fallbackData:[],revalidateOnFocus:!1}),{data:L,mutate:E}=(0,o.ZP)(u?"/chats/".concat(u,"/messages"):null,b,{fallbackData:[],revalidateOnFocus:!1}),{data:T,error:_}=(0,c.Z)(h?"/api/messages/".concat(h,"/events"):null,(e,t)=>{let{next:s}=t,a=new EventSource(e);return a.onmessage=e=>{let t=JSON.parse(e.data);s(null,t.content)},a.onerror=e=>{a.close(),s(e.data,null)},a.addEventListener("end",e=>{a.close();let t=JSON.parse(e.data);E(e=>[...e,t],!1),s(null,null)}),()=>{console.log("CLOSE EVENT SOURCE"),a.close()}});async function C(e){e.preventDefault();let t=e.currentTarget.querySelector("textarea"),s=t.value;if(t.value){if(u){let e=await y.post("/chats/".concat(u,"/messages"),{message:s});E([...L,e],!1),x(e.id)}else{let e=await y.post("/chats",{message:s});k([e,...N],!1),d(e.id),x(e.messages[0].id)}t.value=""}}async function S(){await (0,r.signOut)({redirect:!1});let{url:e}=await y.get("logout-url?".concat(new URLSearchParams({redirect:window.location.origin})));window.location.href=e}return(0,n.useEffect)(()=>{d(s)},[s]),(0,n.useLayoutEffect)(()=>{if(!T)return;let e=document.querySelector("#chatting");e.scrollTop=e.scrollHeight},[T]),(0,a.jsxs)("main",{className:"flex relative w-full h-full overflow-hidden",children:[(0,a.jsxs)("aside",{className:"flex h-screen flex-col w-[300px] p-2 bg-gray-900",children:[(0,a.jsxs)("button",{className:"flex p-3 gap-3 rounded hover:bg-gray-500/10 transition-colors duration-200 text-white cursor-pointer text-sm mb-1 border border-white/20",onClick:()=>{e.push("/"),d(null),x(null)},children:[(0,a.jsx)(j,{className:"w-5 h-5"}),"New chat"]}),(0,a.jsx)("div",{className:"flex-grow overflow-y-auto -mr-2 overflow-hidden",children:null==N?void 0:N.map((t,s)=>(0,a.jsx)("div",{className:"pb-2 text-gray-100 text-sm mr-2",children:(0,a.jsxs)("button",{className:"flex p-3 gap-3 rounded hover:bg-[#3f4679] cursor-pointer hover:pr-4 group w-full",type:"button",onClick:()=>e.push("/?chatId=".concat(t.id)),children:[(0,a.jsx)(v,{className:"h-5 w-5"}),(0,a.jsxs)("div",{className:"max-h-5 overflow-hidden break-all relative w-full text-left",children:[t.messages[0].content,(0,a.jsx)("div",{className:"absolute inset-y-0 right-0 w-8 z-10 bg-gradient-to-l from-gray-900 group-hover:from-[#3f4679]"})]})]})},s))}),(0,a.jsxs)("button",{className:"flex p-3 mt-1 gap-3 rounded hover:bg-gray-500/10 text-sm text-white",onClick:S,children:[(0,a.jsx)(p,{className:"h-5 w-5"}),"Log out"]})]}),(0,a.jsxs)("section",{className:"flex-1 flex-col relative",children:[(0,a.jsxs)("ul",{id:"chatting",className:"h-screen overflow-y-auto bg-gray-800",children:[null==L?void 0:L.map(e=>(0,a.jsx)(f,{content:e.content,is_from_bot:e.is_from_bot},e.id)),T&&(0,a.jsx)(f,{content:T,is_from_bot:!0,loading:!0}),_&&(0,a.jsx)(w,{children:_}),(0,a.jsx)("li",{className:"h-36 bg-gray-800"})]}),(0,a.jsx)("div",{className:"absolute bottom-0 w-full !bg-transparent bg-gradient-to-b from-gray-800 to-gray-950/40",children:(0,a.jsx)("div",{className:"pt-6 mb-6 mx-auto max-w-3xl",children:(0,a.jsx)("form",{ref:g,onSubmit:C,children:(0,a.jsxs)("div",{className:"flex flex-col py-3 pl-4 relative text-white bg-gray-700 rounded",children:[(0,a.jsx)("textarea",{className:"resize-none pr-14 bg-transparent pl-0 outline-none",placeholder:"Type your message...",tabIndex:0,rows:1,onKeyUp:function(e){"Enter"===e.key&&!e.shiftKey&&g.current&&m.current&&g.current.requestSubmit(m.current),e.currentTarget.scrollHeight>=200?e.currentTarget.style.overflowY="scroll":(e.currentTarget.style.overflowY="hidden",e.currentTarget.style.height="auto",e.currentTarget.style.height=e.currentTarget.scrollHeight+"px")},onKeyDown:function(e){"Enter"!==e.key||e.shiftKey||e.preventDefault()}}),(0,a.jsx)("button",{ref:m,type:"submit",className:"absolute top-1 text-gray-400 hover:text-gray-500 transition-colors bottom-2.5 rounded md:right-4",disabled:T,children:(0,a.jsx)(i,{className:"text-white-500 w-8"})})]})})})})]})]})};var k=N},8996:function(e,t,s){Promise.resolve().then(s.bind(s,536))}},function(e){e.O(0,[751,600,667,961,744],function(){return e(e.s=8996)}),_N_E=e.O()}]);